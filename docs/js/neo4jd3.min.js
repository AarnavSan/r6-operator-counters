!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.Neo4jd3=t()}}(function(){return function(){function t(n,e,o){function r(a,l){if(!e[a]){if(!n[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[a]={exports:{}};n[a][0].call(c.exports,function(t){return r(n[a][1][t]||t)},c,c.exports,t,n,e,o)}return e[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}return t}()({1:[function(t,n,e){"use strict";var o=t("./scripts/neo4jd3");n.exports=o},{"./scripts/neo4jd3":2}],2:[function(t,n,e){"use strict";function o(t,n){function e(t){ht=t.append("svg").attr("width","100%").attr("height","100%").attr("class","neo4jd3-graph").call(d3.zoom().on("zoom",function(){var t=d3.event.transform.k,n=[d3.event.transform.x,d3.event.transform.y];mt&&(n[0]+=mt[0],n[1]+=mt[1]),xt&&(t*=xt),ht.attr("transform","translate("+n[0]+", "+n[1]+") scale("+t+")")})).on("dblclick.zoom",null).append("g").attr("width","100%").attr("height","100%"),yt=ht.append("g").attr("class","relationships"),gt=ht.append("g").attr("class","nodes"),ht.append("svg:defs").append("svg:marker").attr("id","triangle").attr("refX",2).attr("refY",2).attr("markerWidth",30).attr("markerHeight",30).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 0 0 4 2 0 4 1 2").style("fill","#a5abb6")}function o(t){return t.append("image").attr("height",function(t){return j(t)?"24px":"70px"}).attr("x",function(t){return j(t)?"5px":"-35px"}).attr("xlink:href",function(t){return E(t)}).attr("y",function(t){return j(t)?"5px":"-35px"}).attr("width",function(t){return j(t)?"24px":"70px"})}function r(t){return t.append("div").attr("class","neo4jd3-info")}function i(t,n,e,o){var r=rt.append("a");r.attr("href","#").attr("class",t).html("<strong>"+e+"</strong>"+(o?": "+o:"")),o||r.style("background-color",function(t){return Mt.nodeOutlineFillColor?Mt.nodeOutlineFillColor:n?x(e):k()}).style("border-color",function(t){return Mt.nodeOutlineFillColor?m(Mt.nodeOutlineFillColor):n?m(e):M()}).style("color",function(t){return Mt.nodeOutlineFillColor?m(Mt.nodeOutlineFillColor):"#fff"})}function a(t,n,e,o){return t.results.forEach(function(t){t.data.forEach(function(t){t.graph.relationships=t.graph.relationships.filter(function(t){return!(!n||"Hard Counter"!==t.type)||(!(!e||"Soft Counter"!==t.type)||!(!o||"Minor Counter"!==t.type))})})}),t}function l(t,n){i(t,!0,n)}function s(t,n,e){"&lt;id&gt;"!==n&&i(t,!1,n,e)}function u(t,n){i(t,!1,n)}function c(){return it.enter().append("g").attr("class",function(t){var n,e,o="node";t.labels[0];if(j(t)&&(o+=" node-icon"),E(t)&&(o+=" node-image"),Mt.highlight)for(e=0;e<Mt.highlight.length;e++)if(n=Mt.highlight[e],t.labels[0]===n.class&&t.properties[n.property]===n.value){o+=" node-highlighted";break}return o}).on("click",function(t){t.fx=t.fy=null,"function"==typeof Mt.onNodeClick&&Mt.onNodeClick(t)}).on("dblclick",function(t){I(t),"function"==typeof Mt.onNodeDoubleClick&&Mt.onNodeDoubleClick(t)}).on("mouseenter",function(t){rt&&K(t),"function"==typeof Mt.onNodeMouseEnter&&Mt.onNodeMouseEnter(t)}).on("mouseleave",function(t){rt&&v(t),"function"==typeof Mt.onNodeMouseLeave&&Mt.onNodeMouseLeave(t)}).call(d3.drag().on("start",N).on("drag",C).on("end",D))}function f(){var t=c();return Mt.icons,Mt.images&&o(t),t}function d(){return lt.enter().append("g").attr("class","relationship").on("dblclick",function(t){"function"==typeof Mt.onRelationshipDoubleClick&&Mt.onRelationshipDoubleClick(t)}).on("mouseenter",function(t){rt&&K(t)})}function p(t){return t.append("path").attr("class","outline link").attr("fill","#a5abb6").attr("marker-end","url(#triangle)")}function h(t){return t.append("path").attr("class","overlay")}function g(t){return t.append("text").attr("class","text").attr("fill","#ffffff").attr("font-size","8px").attr("pointer-events","none").attr("text-anchor","middle").text(function(t){var n=t.type;return Dt[t.endNode+","+t.startNode+","+t.type+","]=!0,n})}function y(){var t=d(),n=g(t);return{outline:p(t),overlay:h(t),relationship:t,text:n}}function x(t){var n=vt[t];return n||(n=Mt.colors[kt%Mt.colors.length],vt[t]=n,kt++),n}function m(t){return d3.rgb(x(t)).darker(1)}function v(){rt.html("")}function b(t,n){return t.filter(function(t){return t.id===n}).length>0}function k(){return Mt.relationshipColor}function M(){return d3.rgb(Mt.colors[Mt.colors.length-1]).darker(1)}function D(t){d3.event.active||pt.alphaTarget(0),"function"==typeof Mt.onNodeDragEnd&&Mt.onNodeDragEnd(t)}function C(t){I(t)}function N(t){d3.event.active||pt.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y,"function"==typeof Mt.onNodeDragStart&&Mt.onNodeDragStart(t)}function j(t){var n;return Mt.iconMap&&Mt.showIcons&&Mt.icons&&(Mt.icons[t.labels[0]]&&Mt.iconMap[Mt.icons[t.labels[0]]]?n=Mt.iconMap[Mt.icons[t.labels[0]]]:Mt.iconMap[t.labels[0]]?n=Mt.iconMap[t.labels[0]]:Mt.icons[t.labels[0]]&&(n=Mt.icons[t.labels[0]])),n}function E(t){var n,e,o,r,i,a,l,s;if(Mt.images&&(e=Mt.imageMap[t.labels[0]]))for(r=0,n=0;n<e.length;n++){switch(a=e[n].split("|"),a.length){case 3:s=a[2];case 2:l=a[1];case 1:i=a[0]}t.labels[0]!==i||l&&void 0===t.properties[l]||s&&t.properties[l]!==s||a.length>r&&(o=Mt.images[e[n]],r=a.length)}return o}function w(){var t,n;for(t in Mt.images)Mt.images.hasOwnProperty(t)&&(n=t.split("|"),Mt.imageMap[n[0]]?Mt.imageMap[n[0]].push(t):Mt.imageMap[n[0]]=[t])}function O(){return d3.forceSimulation().force("collide",d3.forceCollide().radius(function(t){return Mt.minCollision}).iterations(2)).force("charge",d3.forceManyBody()).force("link",d3.forceLink().id(function(t){return t.id})).force("center",d3.forceCenter(ht.node().parentElement.parentElement.clientWidth/2,ht.node().parentElement.parentElement.clientHeight/2)).on("tick",function(){L()}).on("end",function(){Mt.zoomFit&&!bt&&(bt=!0,et(2))})}function F(){at=[],ft=[],G(Mt.neo4jData)}function U(t){at=[],ft=[],d3.json(t,function(t,n){if(t)throw t;n=a(n,Mt.counters[0],Mt.counters[1],Mt.counters[2]),G(n)})}function z(t,n){Object.keys(n).forEach(function(e){t[e]=n[e]})}function R(t){var n={nodes:[],relationships:[]};return t.results.forEach(function(t){t.data.forEach(function(t){t.graph.nodes.forEach(function(t){b(n.nodes,t.id)||n.nodes.push(t)}),t.graph.relationships.forEach(function(t){t.startNode!==t.endNode&&(t.source=t.startNode,t.target=t.endNode,n.relationships.push(t))}),t.graph.relationships.sort(function(t,n){return t.source>n.source?1:t.source<n.source?-1:t.target>n.target?1:t.target<n.target?-1:0});for(var e=0;e<t.graph.relationships.length;e++)0!==e&&t.graph.relationships[e].source===t.graph.relationships[e-1].source&&t.graph.relationships[e].target===t.graph.relationships[e-1].target?t.graph.relationships[e].linknum=t.graph.relationships[e-1].linknum+1:t.graph.relationships[e].linknum=1})}),n}function A(t,n){var e,o,r,i,a={nodes:[],relationships:[]},l=1+(n*Math.random()<<0),s=H();for(e=0;e<l;e++)o=S(),r={id:s.nodes+1+e,labels:[o],properties:{random:o},x:t.x,y:t.y},a.nodes[a.nodes.length]=r,i={id:s.relationships+1+e,type:o.toUpperCase(),startNode:t.id,endNode:s.nodes+1+e,properties:{from:Date.now()},source:t.id,target:s.nodes+1+e,linknum:s.relationships+1+e},a.relationships[a.relationships.length]=i;return a}function S(){var t=Object.keys(Mt.iconMap);return t[t.length*Math.random()<<0]}function q(t,n,e,o,r){var i=Math.PI/180*r,a=Math.cos(i),l=Math.sin(i);return{x:a*(e-t)+l*(o-n)+t,y:a*(o-n)-l*(e-t)+n}}function P(t,n,e){return q(t.x,t.y,n.x,n.y,e)}function W(t,n){return 180*Math.atan2(n.y-t.y,n.x-t.x)/Math.PI}function H(){return{nodes:at.length,relationships:ft.length}}function I(t){t.fx=d3.event.x,t.fy=d3.event.y}function L(){Q(),T()}function Q(){it&&it.attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}function T(){lt&&(lt.attr("transform",function(t){if(!t.linkn){var n=t.source.id+"@@"+t.target.id;Ct[n]||(Ct[n]=1),t.linkn=Ct[n]++}var e={x:0,y:0},o=W(t.source,t.target),r=Y(t.source,t.target),i=X(t.source,t.target),a=P(e,r,-10*t.linkn),l=P(e,{x:0+(Mt.nodeRadius+1)*r.x-i.x,y:0+(Mt.nodeRadius+1)*r.y-i.y},o+10*t.linkn),s=P(e,{x:t.target.x-t.source.x-(Mt.nodeRadius+2)*a.x,y:t.target.y-t.source.y-(Mt.nodeRadius+2)*a.y},o),u=X(l,s),c={x:(l.x+s.x)/2+20*u.x*t.linkn,y:(l.y+s.y)/2+20*u.y*t.linkn};return t.outline={middle:c,source:l,target:s,u:u},"translate("+t.source.x+", "+t.source.y+") rotate("+o+")"}),J(),B(),_())}function B(){lt.each(function(t){d3.select(this).select(".outline").attr("d",function(t){var n=t.outline.source,e=t.outline.target,o=t.outline.middle;return"M "+e.x+", "+e.y+" Q "+o.x+" "+o.y+" "+n.x+" "+n.y+" Q "+o.x+" "+o.y+" "+e.x+", "+e.y})})}function _(){ut.attr("d",function(t){var n=t.outline.source,e=t.outline.target,o=t.outline.middle,r=t.outline.u;return"M "+n.x+", "+n.y+" Q "+(o.x+8*r.x)+" "+(o.y+8*r.y)+" "+e.x+" "+e.y+"Q  "+(o.x-8*r.x)+" "+(o.y-8*r.y)+"  "+n.x+" "+n.y+"Z"})}function J(){ct.attr("transform",function(t){var n=(W(t.source,t.target)+360)%360,e=n>90&&n<270,o=t.outline.source,r=t.outline.target,i=t.outline.u,a={x:(o.x+r.x)/2+i.x*(e?8:10)*t.linkn+i.x,y:(o.y+r.y)/2+i.y*(e?8:10)*t.linkn+i.y};return"translate("+a.x+", "+a.y+") rotate("+(e?180:0)+")"})}function X(t,n,e){return P({x:0,y:0},Y(t,n,e),90)}function Y(t,n,e){var o=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))/Math.sqrt(e||1);return{x:(n.x-t.x)/o,y:(n.y-t.y)/o}}function Z(t){$(t.nodes,t.relationships)}function G(t){Z(R(t))}function K(t){v(),t.labels?l("class",t.labels[0]):u("class",t.type),s("property","&lt;id&gt;",t.id),Object.keys(t.properties).forEach(function(n){s("property",n,JSON.stringify(t.properties[n]))})}function V(t){Array.prototype.push.apply(at,t),it=gt.selectAll(".node").data(at,function(t){return t.id});var n=f();it=n.merge(it)}function $(t,n){tt(n),V(t),pt.nodes(at),pt.force("link").links(ft)}function tt(t){Array.prototype.push.apply(ft,t),lt=yt.selectAll(".relationship").data(ft,function(t){return t.id});var n=y();lt=n.relationship.merge(lt),st=ht.selectAll(".relationship .outline"),st=n.outline.merge(st),ut=ht.selectAll(".relationship .overlay"),ut=n.overlay.merge(ut),ct=ht.selectAll(".relationship .text"),ct=n.text.merge(ct)}function nt(){return Nt}function et(t){var n=ht.node().getBBox(),e=ht.node().parentElement.parentElement,o=e.clientWidth,r=e.clientHeight,i=n.width,a=n.height,l=n.x+i/2,s=n.y+a/2;0!==i&&0!==a&&(xt=.85/Math.max(i/o,a/r),mt=[o/2-xt*l,r/2-xt*s],ht.attr("transform","translate("+mt[0]+", "+mt[1]+") scale("+xt+")"))}var ot,rt,it,at,lt,st,ut,ct,ft,dt,pt,ht,gt,yt,xt,mt,vt={},bt=!1,kt=0,Mt={arrowSize:4,colors:function(){return["#68bdf6","#6dce9e","#faafc2","#f2baf6","#ff928c","#fcea7e","#ffc766","#405f9e","#a5abb6","#78cecb","#b88cbb","#ced2d9","#e84646","#fa5f86","#ffab1a","#fcda19","#797b80","#c9d96f","#47991f","#70edee","#ff75ea"]}(),highlight:void 0,iconMap:void 0,icons:void 0,imageMap:{},images:void 0,infoPanel:!0,minCollision:void 0,neo4jData:void 0,neo4jDataUrl:void 0,nodeOutlineFillColor:void 0,nodeRadius:25,relationshipColor:"#a5abb6",zoomFit:!1,counters:[!0,!0,!1]},Dt={},Ct={},Nt="0.0.1";return function(t,n){z(Mt,n),Mt.icons&&(Mt.showIcons=!0),Mt.minCollision||(Mt.minCollision=2*Mt.nodeRadius),w(),dt=t,ot=d3.select(dt),ot.attr("class","neo4jd3").html(""),Mt.infoPanel&&(rt=r(ot)),e(ot),pt=O(),Mt.neo4jData?F(Mt.neo4jData):Mt.neo4jDataUrl?U(Mt.neo4jDataUrl):console.error("Error: both neo4jData and neo4jDataUrl are empty!")}(t,n),{neo4jDataToD3Data:R,randomD3Data:A,size:H,updateWithD3Data:Z,updateWithNeo4jData:G,version:nt}}n.exports=o},{}]},{},[1])(1)});